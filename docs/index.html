<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="alt1-app" content="appconfig.json" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Alt1 Loot Tracker</title>
    <style>
      body { font-family: sans-serif; margin: 0; padding: 12px; background: #0e0f12; color: #e8e8e8; }
      h1 { margin: 0 0 10px; font-size: 18px; }
      .row { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 10px; align-items:center; }
      button, input { background: #1b1e26; border: 1px solid #2a2f3b; color: #e8e8e8; padding: 8px 10px; border-radius: 8px; }
      button:hover { border-color: #3a4254; cursor: pointer; }
      button:disabled { opacity: 0.5; cursor: not-allowed; }
      .pill { padding: 6px 10px; border-radius: 999px; border: 1px solid #2a2f3b; background:#141722; font-size: 12px; }
      .muted { color: #98a3bf; font-size: 12px; }
      .card { border: 1px solid #222635; background:#11131b; border-radius: 12px; padding: 10px; margin-bottom: 12px; }
      .small { width: 78px; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
      .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
      @media (max-width: 900px) { .grid2 { grid-template-columns: 1fr; } }
      .captureWrap { border:1px solid #222635; border-radius: 12px; padding: 10px; background:#0f1118; }
      #cnvFull { width: 100%; height: 420px; background:#0b0c10; border-radius: 10px; border:1px solid #222635; image-rendering: pixelated; cursor: crosshair; }
      .hint { font-size: 12px; color:#98a3bf; margin-top: 6px; }
      table { width: 100%; border-collapse: collapse; margin-top: 10px; }
      th, td { border-bottom: 1px solid #222635; padding: 8px; text-align: left; font-size: 13px; }
      th { color: #b7c0d8; font-weight: 600; }
      .right { text-align:right; }
    </style>
  </head>
  <body>
    <h1>Alt1 Loot Tracker</h1>

    <div class="row">
      <span class="pill mono" id="diag">diag: loading…</span>
      <span class="pill mono" id="lastAction">last: (none)</span>
    </div>

    <div class="card">
      <div class="row">
        <button id="btnModeInv">Mode: Inventory</button>
        <button id="btnModeMoney">Mode: Money</button>
        <span class="pill" id="modePill">mode: inventory</span>

        <button id="btnCaptureFull">Capture RS Frame</button>
        <button id="btnSaveSelection" disabled>Save Selection</button>
        <button id="btnClearSelection" disabled>Clear Selection</button>
      </div>

      <div class="captureWrap">
        <canvas id="cnvFull"></canvas>
        <div class="hint">
          1) Pick mode → 2) Capture RS Frame → 3) Drag a box → 4) Save Selection.
        </div>
      </div>
    </div>

    <div class="card">
      <div class="muted">Manual regions (x,y,w,h in RS client pixels)</div>

      <div class="row" style="margin-top:8px;">
        <span class="pill">Inventory</span>
        <input id="invX" class="small" placeholder="x" />
        <input id="invY" class="small" placeholder="y" />
        <input id="invW" class="small" placeholder="w" />
        <input id="invH" class="small" placeholder="h" />
        <button id="btnSetInv">Set</button>
        <button id="btnPreviewInv">Preview</button>
        <span class="pill" id="statusInv">Inventory: not set</span>
      </div>

      <div class="row">
        <span class="pill">Money</span>
        <input id="monX" class="small" placeholder="x" />
        <input id="monY" class="small" placeholder="y" />
        <input id="monW" class="small" placeholder="w" />
        <input id="monH" class="small" placeholder="h" />
        <button id="btnSetMoney">Set</button>
        <button id="btnPreviewMoney">Preview</button>
        <span class="pill" id="statusMoney">Money: not set</span>
      </div>

      <div class="grid2" style="margin-top:10px;">
        <div class="captureWrap">
          <div class="muted">Inventory preview</div>
          <canvas id="cnvInv"></canvas>
        </div>
        <div class="captureWrap">
          <div class="muted">Money preview</div>
          <canvas id="cnvMoney"></canvas>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="row">
        <input id="sessionLabel" placeholder="Session label" style="min-width:280px;" />
        <button id="btnStart">Start</button>
        <button id="btnPause" disabled>Pause</button>
        <button id="btnStop" disabled>Stop</button>
        <span class="pill" id="statusRun">Status: idle</span>
      </div>

      <div class="grid2">
        <div>
          <div class="muted">Current session loot</div>
          <table>
            <thead><tr><th></th><th>Item</th><th class="right">Qty</th></tr></thead>
            <tbody id="lootRows"></tbody>
          </table>
        </div>

        <div>
          <div class="muted">Sessions</div>
          <table>
            <thead><tr><th>When</th><th>Label</th><th class="right">Entries</th></tr></thead>
            <tbody id="sessionRows"></tbody>
          </table>
          <div class="row" style="margin-top:10px;">
            <button id="btnClearAll">Clear All Saved Sessions</button>
          </div>
        </div>
      </div>
    </div>

    <script src="./bundle_v8.js"></script>
  </body>
</html>